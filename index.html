<!DOCTYPE html>
<html>
<head>
    <title>Multi-Device Appium</title>
</head>
<body>
    <h1>Devices</h1>
    <button onclick="window.startAll()">Start All Sessions</button>
    <div id="devices"></div>
    
    <script>
        async function refresh() {
            const devices = await window.api.getDevices();
            document.getElementById('devices').innerHTML = devices.map(d => 
                `<div>${d} <button onclick="window.start('${d}')">Start</button></div>`
            ).join('');
        }
        
        window.start = async function(deviceId) {
            console.log('Starting session for:', deviceId);
            const result = await window.api.getSession(deviceId);
            console.log(deviceId, result);
        }
        
        window.startAll = async function() {
            console.log('Starting all sessions...');
            const devices = await window.api.getDevices();
            await Promise.all(devices.map(device => window.start(device)));
        }
        
        setInterval(refresh, 3000);
        refresh();
    </script>
</body>
</html>